<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Embed Qlik Sense App</title>
  <script
    crossorigin="anonymous"
    type="application/javascript"
    src="https://cdn.jsdelivr.net/npm/@qlik/embed-web-components@1/dist/index.min.js"
    data-host="https://keyruspt.eu.qlikcloud.com"
    data-get-access-token="getAccessToken">
  </script>
</head>
<body>
  <h1>Mi aplicaciÃ³n Qlik Sense embebida</h1>

  <div style="height:600px;width:100%">
    <qlik-embed
      ui="classic/app"
      app-id="40de9651-2036-42be-a6e0-86ec38362ad0"
      <!-- sheet-id="XwLsPUk" -->
    ></qlik-embed>
  </div>

  <script>
  async function getAccessToken() {
  const resp = await fetch("https://qlik-backend.vercel.app/api/access-token", {
    method: "GET"
  });

  if (!resp.ok) {
    const errorText = await resp.text();
    throw new Error("Error obteniendo token: " + errorText);
  }

  const json = await resp.json();

  console.log("ðŸ”‘ Token recibido:", json.access_token); // <-- AquÃ­ lo ves en la consola
  return json.access_token;
  }
  </script>

  <script src="script.js"></script>
</body>
</html>
